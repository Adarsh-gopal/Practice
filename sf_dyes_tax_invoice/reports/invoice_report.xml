<?xml version="1.0" encoding="utf-8"?>
<odoo>
<data>
    <report
        id="account.account_invoices"
        model="account.move"
        string="Invoices"
        report_type="qweb-pdf"
        name="account.report_invoice_with_payments"
        file="account.report_invoice_with_payments"
        attachment="(object.state == 'posted') and ((object.name or 'INV').replace('/','_')+'.pdf')"
        print_report_name="(object._get_report_base_filename())"
        groups="account.group_account_invoice"
        menu="False"
    />

    <report
        id="account.account_invoices_without_payment"
        model="account.move"
        string="Invoices without Payment"
        report_type="qweb-pdf"
        name="account.report_invoice"
        file="account.report_invoice"
        attachment="(object.state == 'posted') and ((object.name or 'INV').replace('/','_')+'.pdf')"
        print_report_name="(object._get_report_base_filename())"
        menu="False"
    />

    <record id="sf_page_format" model="report.paperformat">
        <field name="name">SF tax invoice page format</field>
        <field name="default" eval="True"/>
        <field name="format">A4</field>
        <field name="orientation">Portrait</field>
        <field name="margin_top">130</field>
        <field name="margin_bottom">28</field>
        <field name="margin_left">5</field>
        <field name="margin_right">5</field>
        <field name="header_line" eval="False"/>
        <field name="header_spacing">130</field>
        <field name="dpi">90</field>
    </record>

    <report
        id="custom_invoice_report"
        model="account.move"
        string="Tax Invoice"
        report_type="qweb-pdf"
        name="sf_dyes_tax_invoice.report_invoice"
        file="sf_dyes_tax_invoice.report_invoice"
        print_report_name="(object._get_report_base_filename())"
        attachment="(object.state in ('open','in_payment','paid')) and ('INV'+(object.number or '').replace('/','')+'.pdf')"
        paperformat="sf_dyes_tax_invoice.sf_page_format"
    />

    <template id="report_invoice">
    <t t-call="web.html_container">
    <t t-foreach="docs" t-as="o">
    <t t-call="sf_dyes_tax_invoice.external_layout_standard_sf">
    <table class="table" style="border:1px solid black;border-top:2px solid white;width:100%;padding-top:70px;margin-top:20px;">
        <thead>
        <tr>
            <td style="border:2px solid black;text-align:center;font-size:13px;width:1%">
                Sl.No.
            </td>
            <td style="border:2px solid black;text-align:center;font-size:13px;width:20%" colspan="2">
                Item Description
            </td>
            <td style="border:2px solid black;text-align:center;font-size:13px;width:10%">
                HSN/SAC
            </td>
            <td style="border:2px solid black;text-align:center;font-size:13px;width:9%">
                No. of Pkgs
            </td>
            <td style="border:2px solid black;text-align:center;font-size:13px;width:10%">
                PKG Size
            </td>
            <td style="border:2px solid black;text-align:center;font-size:13px;width:10%">
                Unit
            </td>
            <td style="border:2px solid black;text-align:center;font-size:13px;width:10%">
                Quantity
            </td>
            <td style="border:2px solid black;text-align:center;font-size:13px;width:15%">
                Rate
            </td>
            <td style="border:2px solid black;text-align:center;font-size:13px;width:15%">
                Taxable Value
            </td>
        </tr>
    </thead>
        <t t-set="sl" t-value="1"/>
        <t t-foreach="o.invoice_line_ids" t-as="line">
            <tr>
                <td style="border:2px solid black;text-align:center;font-size:13px;width:1%">
                    <span t-esc="sl"/>
                    <t t-set="sl" t-value="sl+1"/>
                </td>
                <!-- added iot name using loop(03-06-2020) -->
                <td style="border:2px solid black;text-align:left;font-size:13px;width:20%" colspan="2">
                    <span t-field="line.product_id.name"/><br/>
                <!--<t t-set="lot_values" t-value="o._get_invoiced_lot_values()"/>
                    <t t-if="lot_values">
                        <t t-foreach="lot_values" t-as="lot">
                            <t t-if="lot['product_name'] == line.product_id.name">
                                <span t-esc="lot.name"/>,
                            </t>
                        </t>
                    </t> -->
                    <t t-if="line.lots_list != 'set()'">
                    Batch No:
                        <span t-esc="line.lots_list"/>
                    </t>
                </td>
                <td style="border:2px solid black;text-align:center;font-size:13px;width:10%">
                    <t t-if="line.product_id.l10n_in_hsn_code">
                        <span t-field="line.product_id.l10n_in_hsn_code"/>
                    </t>
                </td>
                <td style="border:2px solid black;text-align:center;font-size:13px;width:9%">
                    <t t-if="line.product_packaging">
                        <span t-field="line.z_package"/>
                    </t>
                </td>
                <td style="border:2px solid black;text-align:center;font-size:13px;width:10%">
                    <t t-if="line.product_packaging">
                        <span t-field="line.product_packaging"/>
                    </t>
                </td>
                <td style="border:2px solid black;text-align:center;font-size:13px;width:10%">
                    <span t-field="line.product_uom_id"/>
                </td>
                <td style="border:2px solid black;text-align:center;font-size:13px;width:10%">
                    <span t-esc="'%.1f'%(line.quantity)"/>
                </td>
                <td style="border:2px solid black;text-align:right;font-size:13px;width:15%">
                    <span t-field="line.price_unit"/>
                </td>
                <td style="border:2px solid black;text-align:right;font-size:13px;width:15%">
                    <span t-field="line.price_subtotal"/>
                </td>
            </tr>
        </t>
        <tr>
            <td style="border:2px solid black;text-align:left;font-size:13px;" colspan="7"><br/>
                <t t-foreach="o.amount_by_group" t-as="tax_line">
                    Total <span t-esc="tax_line[0]"/> in Words: 
                    <span t-esc="o.currency_id.amount_to_text(tax_line[1])"/><br/>
                    <!-- <span t-esc="o.amt_in_words_ti('%.2f'%(tax_line[1]))"/><br/> -->
                </t>
                Total Invoice Value in Words: 
                <span t-esc="o.currency_id.amount_to_text(o.amount_total)"/>
            </td>
            <td style="border:2px solid black;text-align:left;font-size:13px;" colspan="2">
                Taxable Amount<br/>
                <t t-foreach="o.amount_by_group" t-as="tax_line">
                    <!-- <t t-set="percent" t-value="round(tax_line[1]/(o.amount_untaxed/100))"/> -->
                    <span t-esc="tax_line[0]"/> @ <span t-esc="percent"/> %<br/>
                </t>
                <strong>TOTAL</strong>
            </td>
            <td style="border:2px solid black;text-align:right;font-size:13px;" colspan="2">
                <span t-field="o.amount_untaxed"/><br/>
                <t t-foreach="o.amount_by_group" t-as="tax_line">
                     <span t-field="o.currency_id.symbol"/>
                     <span t-esc="'%.2f'%(tax_line[1])"/> <br/>
                </t>
                <strong><span t-field="o.amount_total"/></strong>
            </td>
        </tr>
        <tr >
            <td colspan="7" style="border:2px solid black;padding:15px;text-align:justfy;font-size:13px;"><b>
                Terms</b><br/>
                1. Subject To Mumbai Jurisdiction<br/>
                2. No Claims will be recognised unless notifies in writing within 8 days of reciept of goods<br/>
                3. Interest @24% per annum will be charged if payment is not made within the due date<br/>
                Declaration:<br/>
                Certified that the particulars given above are true and correct and the amount indicated represents the price actually charged and that there is no flow of additional consideration directly or indirectly from buyer.
            </td>
            <td colspan="3" style="text-align:center;padding:1px;border:2px solid black;font-size:13px;">
                <span style="padding-left:2px;"><strong>for SF Dyes Private Ltd</strong></span>
            </td>
        </tr>
        <tr>
            <td style="text-align:center;font-size:13px;border:2px solid white;border-top:2px solid black;width:100%" colspan="10">
                <span>
                    Registered Office : 9 Sprott Road, Ballard Estate, Mumbai 400001, India.
                </span>
                <span> CIN No</span>
                    <span t-field="o.company_id.company_registry"/>
                <span> PAN No AAABCS5098L</span>
            </td>
        </tr>
    </table>                    
    </t>
    </t>
    </t>
    </template>
</data>
</odoo>